<class
    name = "joex_server"
    title = "Joe extended Server"
    script = "zproto_server_c"
    protocol_class = "joex_proto"
    package_dir = "../include"
    project_header = "joex.h"
    export_macro = "JOEX_EXPORT"
    >
    This is server implementation of JOE eXtended protocol
    <include filename = "../license.xml" />

    <state name = "start">
        <event name = "HELLO" next="connected">
            <action name = "register_new_client" />
            <action name = "send" message = "OK" />
        </event>

        <event name = "exception">
            <action name = "signal duplicated client" />
            <action name = "send" message = "ERROR" />
        </event>

        <event name = "*">
            <action name = "signal command invalid" />
            <action name = "send" message = "ERROR" />
        </event>
    </state>
    
    <state name = "connected">
        <event name = "CLOSE" next="start">
            <action name = "unregister_client" />
            <action name = "send" message = "OK" />
        </event>

        <event name = "*">
            <action name = "signal command invalid" />
            <action name = "send" message = "ERROR" />
        </event>
    </state>

</class>
